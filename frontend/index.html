<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>SonicStream</title>
</head>

<body style="background:#111;color:white;font-family:sans-serif;text-align:center">

  <h1>SonicStream</h1>

  <input id="url" style="width:60%;padding:10px" placeholder="Paste YouTube / FB URL">
  <br><br>

  <button onclick="go()">Download MP3</button>

  <p id="msg"></p>

  <script>
    async function go() {

      const url = document.getElementById("url").value;
      const msg = document.getElementById("msg");

      msg.innerText = "Downloading...";

      try {

        const res = await fetch("/convert/url", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ url })
        });

        if (!res.ok) {
          throw new Error(await res.text());
        }

        const blob = await res.blob();

        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "audio.mp3";
        a.click();

        msg.innerText = "Done âœ…";

      } catch (e) {
        msg.innerText = "Error: " + e.message;
      }
    }
  </script>

</body>

</html>